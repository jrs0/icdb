# Each level of this file has the same structure: a docs, source, and <contents> field. The <contents> field
# can be one of: "databases", "tables", "columns", or "strategy", which determines whether the level refers to a
# list of databases, tables, or columns, respectively.
databases:
  sus:
    docs: "The SUS database contains hospital episode statistics, which contain records of patient care activities that take place in a hospital visit."
    source_database: "ABI"
    tables:
      # Start and end dates and times were obtained by greping column
      # names for "(D|d)ate" and "(T|t)ime". Note that all occurances
      # of "Date" and "Time" used capital start letters.
      apc:
        docs: "The APC (admitted patient care) contains records from patients who have been admitted into the hospital. The rows in the table correspond to episodes: individual care activities performed by one consultant. Groups of rows are organised into spells, which represent the entirety of the patient's stay in hospital."
        source_table: "vw_APC_SEM_001"
        columns:
          nhs_number:
            docs: "The NHS number identifies the patient. The field is anonymised."
            source_columns:
              "AIMTC_Pseudo_NHS": ""
              "NHSnumber": "This one looks like it is NULL everywhere. Also, this is an INT column"
            strategy: "coalesce_exclude_null"
          episode_start:
            docs: "A datetime field that is the time when the episode began."
            source_columns:
              "StartDate_ConsultantEpisode": "something"
              "StartDate1": "something"
              "StartTime_Episode": "something"
            strategy: "coalesce"
          episode_end:
            docs: "A datetime field that is the time when the episode finished."
            source_columns:
              "EndDate_ConsultantEpisode": "something"
              "EndDate1": "something"
              "EndTime_Episode": "something"
            strategy: "coalesce"
          primary_diagnosis:
            docs: "The main diagnosis for this episode? The field is an ICD 10 code."
            source_columns:
              "DiagnosisPrimary_ICD": ""
            strategy: ["codes_from", "acs_codes.yaml"]
          spell_id:
            docs: "The ID field linking episodes that form part of the same spell (a continuous hospital visit). "
            source_columns:
              "PBRspellID": ""
            strategy: "coalesce"
          spell_start:
            docs: "A datetime field that is the time when the associated spell for this episode began."
            source_columns:
              "AIMTC_ProviderSpell_Start_Date": ""
              "StartDate_HospitalProviderSpell": ""
              "StartTime_HospitalProviderSpell": ""
            strategy: "coalesce"
          spell_end:
            docs: "A datetime field that is the time when the associated spell for this episode ended."
            source_columns:
              "AIMTC_ProviderSpell_End_Date": ""
              "DischargeDate_FromHospitalProviderSpell": ""
              "DischargeTime_HospitalProviderSpell": ""
            related_columns:
              "HospitalProviderSpellDischargeReadyDate": "probably not the end date, but maybe related."
            strategy: "coalesce"

      ae:
        docs: "The A&E HES data"
        source_table: "vw_AE_SEM_001"
        columns: []

  swd:
    docs: "The MODELLING_SQL_AREA database contains the System Wide Dataset tables (activity, attributes, measurements), which bring together data from primary care (GPs), secondary care (hsopitals), mental health, and community care services."
    source_database: "MODELLING_SQL_AREA"
    tables:
      activity:
        docs: "The SWD activity table contains records of healthcare encounters (e.g. a GP appointment) from  primary care (GPs), secondary care (hsopitals), mental health, and community care services."
        source_table: "test___test"
        columns:
          nhs_number:
            docs: "The NHS number identifies the patient. The field is anonymised."
            source_columns:
              "nhs_number": ""
            strategy: "coalesce_exclude_null"
      attributes:
        docs: "The SWD attributes table contains records of patient attributes at snapshots through the year (monthly updates)."
        source_table: "primary_care_attributes"
        columns:
          nhs_number:
            docs: "The NHS number identifies the patient. The field is anonymised."
            source_columns:
              "nhs_number": ""
            strategy: "coalesce_exclude_null"
