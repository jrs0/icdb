# Each level of this file has the same structure: a docs, source, and <contents> field. The <contents> field
# can be one of: "databases", "tables", "columns", or "strategy", which determines whether the level refers to a
# list of databases, tables, or columns, respectively.
- database: "sus"
  docs: "The SUS database contains hospital episode statistics, which contain records of patient care activities that take place in a hospital visit."
  source: "ABI"
  tables:
    ## When you use the include key, all the information in the specified file will be pasted as-is at
    ## the level where the include key is written. Here, where there is a dash in front of the include,
    ## this means that the entire contents of the include is one dictionary which is stored inside this
    ## list element. Compare with the includes below which do not use a dash (those include files themselves
    ## are lists.
    - include: "apc_episodes.yaml"
    - include: "apc_spells.yaml"

- database: "mort"
  docs: "There are two main tables containing death information....."
  source: "ABI"
  tables:
    - table: "civ-reg"
      docs: "The Civil Registry Mortality table contains information about when a person died and what they died of, listed as ICD10 diagnosis codes. It also has lots of other information, such as where they died."
      source: "test_lookup_test"
      # Raw is used to import all the columns as-is. This overrides the columns key. Mapping the columns properly is preferred.
      raw: yes
      columns: []

    - table: "nhais"
      docs: "NHAIS Deaths table...."
      source: "test_lookup_test"
      columns: []


- database: "swd"
  docs: "The MODELLING_SQL_AREA database contains the System Wide Dataset tables (activity, attributes, measurements), which bring together data from primary care (GPs), secondary care (hsopitals), mental health, and community care services."
  source: "MODELLING_SQL_AREA"
  tables:
    include: "swd.yaml"
    
    - table: "act"
      raw: yes
      columns: []

   - table: "att"
        raw: yes
        columns: []

      attr_h:
        docs: "The SWD attributes-history table contains every monthly snapshot of patient attributes going back to inception of the swd attributes table in 201X(?when, look this up)."
        source_table: "primary_care_attributes"
        raw: yes
        columns: []

      meas:
        docs: "The SWD results, or measurements, table now contains results from various tests. As there are many different types of measures all stored in a single column, this data is stored as character strings and needs to be parsed - e.g. blood pressure = as.character('123/80')."
        source_table: "swd_measurement"
        raw: yes
        columns: []

      lsoa:
        docs: "The LSOA (Lower Super Output Area) table contains details about the local areas in Bristol. We need this as it provides the key for matching patients to the various local 'regions' - in order of size: 'wards', 'LSOAs' and 'MSOAs' (Middle Super Output Areas). TODO: there are quite a few of these tables, find the right one"
        source_table: "swd_LSOA_descriptions"
        raw: yes
        columns: []
