- table: "apc_spells"
    docs: "The admitted patient care spells table collates the APC episodes into spells. I'm not sure who creates this table and how they derive the spell data (e.g. the primary diagnosis for the spell)"
    source_table: "vw_APC_SEM_Spell_001"
    columns:
      nhs_number:
        docs: "The NHS number identifies the patient. The field is anonymised."
        source_columns:
          "AIMTC_Pseudo_NHS": ""
          "NHSnumber": "This one looks like it is NULL everywhere. Also, this is an INT column"
        strategy: "coalesce_exclude_null"
        use: yes
      # age:
      #   docs: "Derived age (anonymised somehow, because it comes from the AIMTC folumn)"
      #   source_columns:
      #     "AIMTC_Age"
      #   strategy: "coalesce"
      #   use: yes
      primary_diagnosis:
        docs: "The main diagnosis for this episode? The field is an ICD 10 code."
        source_columns:
          "DiagnosisPrimary_ICD": ""
        strategy:
          - "coalesce"
          - "codes_from":
             codes_files: "icd10/"      
        use: yes
      spell_id:
        docs: "The ID field linking episodes that form part of the same spell (a continuous hospital visit). "
        source_columns:
          "PBRspellID": ""
        strategy: "coalesce"
        use: yes
      spell_start:
        docs: "A datetime field that is the time when the associated spell for this episode began."
        source_columns:
          "AIMTC_ProviderSpell_Start_Date": ""
          "StartDate_HospitalProviderSpell": ""
          "StartTime_HospitalProviderSpell": ""
        strategy: "coalesce"
        use: yes
      spell_end:
        docs: "A datetime field that is the time when the associated spell for this episode ended."
        source_columns:
          "AIMTC_ProviderSpell_End_Date": ""
          "DischargeDate_FromHospitalProviderSpell": ""
          "DischargeTime_HospitalProviderSpell": ""
        related_columns:
          "HospitalProviderSpellDischargeReadyDate": "probably not the end date, but maybe related."
        strategy: "coalesce"
        use: yes
